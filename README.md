# token-file-api

## Описание

Этот сервис предоставляет REST API для работы с файлами, авторизацией с использованием JWT-токенов, а также обработки данных пользователей и их файлов. Реализован на фреймворке Express.js и использует MySQL для хранения данных.

## Технологии

- **Node.js** и **Express.js** - для построения REST API.
- **JWT** (JSON Web Tokens) - для авторизации пользователей.
- **MySQL** - для хранения данных.
- **CORS** - для работы с API с любых доменов.
- **Docker** — для контейнеризации приложения, облегчая его развертывание и переносимость.
- **Docker Compose** — для упрощения развертывания нескольких сервисов (например, приложения и базы данных) в одном контейнере с автоматической настройкой зависимостей между ними.

## Установка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/tatiana-shulzhik/token-file-api.git
   cd token-file-api
   ```

2. Установите зависимости:

   ```bash
   npm install
   ```

3. Для разработки используйте `.env` файл для конфигурации, его пример находится в .env.example

## Запуск

Чтобы развернуть проект с использованием Docker и Docker Compose, выполните следующую команду:

```bash
docker compose up -d
```
Сервер будет работать на порту, указанном в переменной окружения `PORT` (по умолчанию 3000).

## API

### 1. `/signin [POST]`
Получить JWT-токен по ID и паролю.

**Тело запроса:**:
```json
{
    "login": "е@gmail.com",
    "password": "Password1!"
}
```

**Ответ**:
- Возвращает JWT-токен и refresh-токен.

### 2. `/signin/new_token [POST]`
Обновить JWT-токен с помощью refresh-токена.

**Тело запроса:**:
```json
{
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsInNlc3Npb25JZCI6MywiaWF0IjoxNzM5OTk3ODY3LCJleHAiOjE3NDA2MDI2Njd9.KcGTjhwUI6n2QHQMxq_cYhmgoMW36WTQMEiWCAW6FTc"
}
```

**Ответ**:
- Возвращает новый JWT-токен

### 3. `/signup [POST]`
Регистрация нового пользователя.

**Тело запроса:**:
```json
{
    "login": "е@gmail.com",
    "password": "Password1!"
}
```

**Ответ**:
- Возвращает сообщение об успешной регистрации.

### 4. `/file/upload [POST]`
Загрузка нового файла.

**Параметры запроса**:
- `file` — файл для загрузки.

**Ответ**:
- Возвращает информацию о файле (имя, MIME-тип, размер и дата загрузки).

### 5. `/file/list [GET]`
Получить список файлов с пагинацией.

**Параметры запроса**:
- `page` — номер страницы (по умолчанию 1).
- `list_size` — количество записей на странице (по умолчанию 10).

**Ответ**:
- Возвращает список файлов.

### 6. `/file/delete/:id [DELETE]`
Удалить файл по ID.

**Параметры запроса**:
- `id` — идентификатор файла.

**Ответ**:
- Возвращает сообщение о успешном удалении.

### 7. `/file/:id [GET]`
Получить информацию о файле по ID.

**Параметры запроса**:
- `id` — идентификатор файла.

**Ответ**:
- Возвращает информацию о файле.

### 8. `/file/download/:id [GET]`
Скачать файл по ID.

**Параметры запроса**:
- `id` — идентификатор файла.

**Ответ**:
- Файл для скачивания.

### 9. `/file/update/:id [PUT]`
Обновить файл по ID.

**Параметры запроса**:
- `id` — идентификатор файла.
- `file` — новый файл.

**Ответ**:
- Возвращает информацию о обновленном файле.

### 10. `/info [GET]`
Получить ID текущего пользователя, авторизованного с помощью JWT-токена.

**Ответ**:
- Возвращает ID пользователя.

### 11. `/logout [POST]`

**Тело запроса:**:
```json
{
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsInNlc3Npb25JZCI6MywiaWF0IjoxNzM5OTk3ODY3LCJleHAiOjE3NDA2MDI2Njd9.KcGTjhwUI6n2QHQMxq_cYhmgoMW36WTQMEiWCAW6FTc"
}
```

**Ответ**:
- Возвращает сообщение об успешном выходе.

